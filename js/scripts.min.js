window.onload=function(){document.body.classList.add("loaded_hiding"),window.setTimeout((function(){document.body.classList.add("loaded"),document.body.classList.remove("loaded_hiding")}),500)};const sectionHero=document.querySelector(".section__hero"),sectionAbout=document.querySelector(".section__about"),sectionSkills=document.querySelector(".section__skills"),sectionLibrary=document.querySelector(".section__library"),sectionPortfolio=document.querySelector(".section__portfolio");if(sectionHero){var typed=new Typed(".type",{strings:["Веб-разработчик","Верстальщик","Фрилансер"],typeSpeed:100,backSpeed:100,loop:!0});document.querySelector(".logo-button").addEventListener("click",(()=>{document.querySelector(".logo-button, .section__hero").classList.toggle("right-cube")})),gsap.from(".middle-hero__library-link",{duration:.6,y:-300,ease:"none"}),gsap.from(".middle-hero__portfolio-link",{duration:.6,y:-300,ease:"none"}),gsap.from(".footer-hero a",{duration:.6,y:300,ease:"none"}),gsap.from(".header-hero",{duration:1,y:-200,ease:"power4.out"}),gsap.from(".socials__line",{duration:.8,y:100,ease:"none"});gsap.timeline().from(".vk",{opacity:0,y:180,duration:.9}).from(".whatsapp",{opacity:0,y:40,duration:.5}).from(".telegram",{opacity:0,y:40,duration:.4}).from(".git",{opacity:0,y:40,duration:.3}).from(".email",{opacity:0,y:40,duration:.2})}else if(sectionAbout){var cvs=document.getElementById("cvs");cvs.height=window.innerHeight,cvs.width=window.innerWidth;var ctx=cvs.getContext("2d"),font="arial",fontSize=10;ctx.font=fontSize+"px "+font;var charSet,cols=cvs.width/fontSize;charSet=(charSet="0123456789ABCDEF").split("");for(var drops=[],col=0;col<cols;col++)drops[col]=Math.floor(Math.random()*cvs.height);function rain(){ctx.fillStyle="rgba(0, 0, 0, 0.05)",ctx.fillRect(0,0,cvs.width,cvs.height);for(var e=0;e<drops.length;e++){var t=charSet[Math.floor(Math.random()*charSet.length)];ctx.fillStyle=randColour(),ctx.fillText(t,e*fontSize,drops[e]*fontSize),Math.random()>.99&&(drops[e]=0),drops[e]++}}function randColour(){return"rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")"}setInterval(rain,25)}else if(sectionSkills){const e=document.getElementById("canvas-skills"),t=e.getContext("2d");let n;e.width=window.innerWidth,e.height=window.innerHeight;let i={x:null,y:null,radius:e.height/80*(e.width/80)};window.addEventListener("mousemove",(e=>{i.x=e.x,i.y=e.y}));class o{constructor(e,t,n,i,o,r){this.x=e,this.y=t,this.directionX=n,this.directionY=i,this.size=o,this.color=r}draw(){t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI,!1),t.fillStyle="rgba(7, 0, 0, 0.447)",t.fill()}update(){(this.x>e.width||this.x<0)&&(this.directionX=-this.directionX),(this.y>e.height||this.y<0)&&(this.directionY=-this.directionY);let t=i.x-this.x,n=i.y-this.y;Math.sqrt(t*t+n*n)<i.radius+this.size&&(i.x<this.x&&this.x<e.width-10*this.size&&(this.x+=10),i.x>this.x&&this.x>10*this.size&&(this.x-=10),i.y<this.y&&this.y<e.height-10*this.size&&(this.y+=10),i.y>this.y&&this.y>10*this.size&&(this.y-=10)),this.x+=this.directionX,this.y+=this.directionY,this.draw()}}init=()=>{n=[],console.log("...");let t=e.height*e.width/9e3;for(let e=0;e<2*t;e++){let e=5*Math.random()+1,t=Math.random()*(innerWidth-2*e-2*e)+2*e,i=Math.random()*(innerHeight-2*e-2*e)+2*e,r=5*Math.random()-2.5,a=5*Math.random()-2.5,s="rgba(7, 0, 0, 0.447)";n.push(new o(t,i,r,a,e,s))}},animate=()=>{requestAnimationFrame(animate),t.clearRect(0,0,innerWidth,innerHeight);for(let e=0;e<n.length;e++)n[e].update();connect()},connect=()=>{for(let i=0;i<n.length;i++)for(let o=i;o<n.length;o++){(n[i].x-n[o].x)*(n[i].x-n[o].x)+(n[i].y-n[o].y)*(n[i].y-n[o].y)<e.width/10*(e.height/10)&&(t.strokeStyle="rgba(7, 0, 0, 0.447)",t.lineWidth=1,t.beginPath(),t.moveTo(n[i].x,n[i].y),t.lineTo(n[o].x,n[o].y),t.stroke())}},window.addEventListener("resize",(()=>{e.width=innerWidth,e.height=innerHeight,i.radius=e.height/80*(e.height/80),init()})),window.addEventListener("mouseout",(()=>{i.x=void 0})),init(),animate()}else if(sectionLibrary){Array.prototype.last=function(){return this[this.length-1]},Math.sinus=function(e){return Math.sin(e/180*Math.PI)};let e,t,n,i,o="waiting",r=[],a=[],s=[],l=0;const d=375,c=375,h=100,u=10,m=100,g=10,w=.2,f=100,y=10,p=1,v=70,x=20,S=.5,T=4,k=4,b=4,M=2,E=2,L=17,_=30,P=document.getElementById("game");P.width=window.innerWidth,P.height=window.innerHeight;const H=P.getContext("2d"),q=document.getElementById("introduction"),W=document.getElementById("perfect"),I=document.getElementById("restart"),z=document.getElementById("score");function resetGame(){o="waiting",e=void 0,i=0,l=0,q.style.opacity=1,W.style.opacity=0,I.style.display="none",z.innerText=l,r=[{x:50,w:50}],generatePlatform(),generatePlatform(),generatePlatform(),generatePlatform(),a=[{x:r[0].x+r[0].w,length:0,rotation:0}],s=[],generateTree(),generateTree(),generateTree(),generateTree(),generateTree(),generateTree(),generateTree(),generateTree(),generateTree(),generateTree(),t=r[0].x+r[0].w-u,n=0,draw()}function generateTree(){const e=s[s.length-1];const t=(e?e.x:0)+30+Math.floor(120*Math.random()),n=["#6D8821","#8FAC34","#98B333"][Math.floor(3*Math.random())];s.push({x:t,color:n})}function generatePlatform(){const e=r[r.length-1];const t=e.x+e.w+40+Math.floor(160*Math.random()),n=20+Math.floor(80*Math.random());r.push({x:t,w:n})}function animate(r){if(!e)return e=r,void window.requestAnimationFrame(animate);switch(o){case"waiting":return;case"stretching":a.last().length+=(r-e)/T;break;case"turning":if(a.last().rotation+=(r-e)/k,a.last().rotation>90){a.last().rotation=90;const[e,t]=thePlatformTheStickHits();e&&(l+=t?2:1,z.innerText=l,t&&(W.style.opacity=1,setTimeout((()=>W.style.opacity=0),1e3)),generatePlatform(),generateTree(),generateTree()),o="walking"}break;case"walking":{t+=(r-e)/b;const[n]=thePlatformTheStickHits();if(n){const e=n.x+n.w-u;t>e&&(t=e,o="transitioning")}else{const e=a.last().x+a.last().length+L;t>e&&(t=e,o="falling")}break}case"transitioning":{i+=(r-e)/M;const[t]=thePlatformTheStickHits();i>t.x+t.w-m&&(a.push({x:t.x+t.w,length:0,rotation:0}),o="waiting");break}case"falling":{a.last().rotation<180&&(a.last().rotation+=(r-e)/k),n+=(r-e)/E;const t=h+100+(window.innerHeight-c)/2;if(n>t)return void(I.style.display="block");break}default:throw Error("Wrong phase")}draw(),window.requestAnimationFrame(animate),e=r}function thePlatformTheStickHits(){if(90!=a.last().rotation)throw Error(`Stick is ${a.last().rotation}°`);const e=a.last().x+a.last().length,t=r.find((t=>t.x<e&&e<t.x+t.w));return t&&t.x+t.w/2-g/2<e&&e<t.x+t.w/2+g/2?[t,!0]:[t,!1]}function draw(){H.save(),H.clearRect(0,0,window.innerWidth,window.innerHeight),drawBackground(),H.translate((window.innerWidth-d)/2-i,(window.innerHeight-c)/2),drawPlatforms(),drawHero(),drawSticks(),H.restore()}function drawPlatforms(){r.forEach((({x:e,w:t})=>{H.fillStyle="black",H.fillRect(e,c-h,t,h+(window.innerHeight-c)/2),a.last().x<e&&(H.fillStyle="red",H.fillRect(e+t/2-g/2,c-h,g,g))}))}function drawHero(){H.save(),H.fillStyle="black",H.translate(t-L/2,n+c-h-_/2),drawRoundedRect(-L/2,-_/2,L,_-4,5);H.beginPath(),H.arc(5,11.5,3,0,2*Math.PI,!1),H.fill(),H.beginPath(),H.arc(-5,11.5,3,0,2*Math.PI,!1),H.fill(),H.beginPath(),H.fillStyle="white",H.arc(5,-7,3,0,2*Math.PI,!1),H.fill(),H.fillStyle="red",H.fillRect(-L/2-1,-12,L+2,4.5),H.beginPath(),H.moveTo(-9,-14.5),H.lineTo(-17,-18.5),H.lineTo(-14,-8.5),H.fill(),H.beginPath(),H.moveTo(-10,-10.5),H.lineTo(-15,-3.5),H.lineTo(-5,-7),H.fill(),H.restore()}function drawRoundedRect(e,t,n,i,o){H.beginPath(),H.moveTo(e,t+o),H.lineTo(e,t+i-o),H.arcTo(e,t+i,e+o,t+i,o),H.lineTo(e+n-o,t+i),H.arcTo(e+n,t+i,e+n,t+i-o,o),H.lineTo(e+n,t+o),H.arcTo(e+n,t,e+n-o,t,o),H.lineTo(e+o,t),H.arcTo(e,t,e,t+o,o),H.fill()}function drawSticks(){a.forEach((e=>{H.save(),H.translate(e.x,c-h),H.rotate(Math.PI/180*e.rotation),H.beginPath(),H.lineWidth=2,H.moveTo(0,0),H.lineTo(0,-e.length),H.stroke(),H.restore()}))}function drawBackground(){var e=H.createLinearGradient(0,0,0,window.innerHeight);e.addColorStop(0,"#BBD691"),e.addColorStop(1,"#FEF1E1"),H.fillStyle=e,H.fillRect(0,0,window.innerWidth,window.innerHeight),drawHill(f,y,p,"#95C629"),drawHill(v,x,S,"#659F1C"),s.forEach((e=>drawTree(e.x,e.color)))}function drawHill(e,t,n,i){H.beginPath(),H.moveTo(0,window.innerHeight),H.lineTo(0,getHillY(0,e,t,n));for(let i=0;i<window.innerWidth;i++)H.lineTo(i,getHillY(i,e,t,n));H.lineTo(window.innerWidth,window.innerHeight),H.fillStyle=i,H.fill()}function drawTree(e,t){H.save(),H.translate((-i*w+e)*p,getTreeY(e,f,y));H.fillStyle="#7D833C",H.fillRect(-1,-5,2,5),H.beginPath(),H.moveTo(-5,-5),H.lineTo(0,-30),H.lineTo(5,-5),H.fillStyle=t,H.fill(),H.restore()}function getHillY(e,t,n,o){const r=window.innerHeight-t;return Math.sinus((i*w+e)*o)*n+r}function getTreeY(e,t,n){const i=window.innerHeight-t;return Math.sinus(e)*n+i}resetGame(),resetGame(),window.addEventListener("keydown",(function(e){if(" "==e.key)return e.preventDefault(),void resetGame()})),window.addEventListener("mousedown",(function(t){"waiting"==o&&(e=void 0,q.style.opacity=0,o="stretching",window.requestAnimationFrame(animate))})),window.addEventListener("mouseup",(function(e){"stretching"==o&&(o="turning")})),window.addEventListener("resize",(function(e){P.width=window.innerWidth,P.height=window.innerHeight,draw()})),window.requestAnimationFrame(animate),I.addEventListener("click",(function(e){e.preventDefault(),resetGame(),I.style.display="none"}))}else if(sectionPortfolio){const e=document.querySelector(".portfolio__carousel"),t=document.querySelectorAll(".carousel__item");document.querySelectorAll(".carousel__item img");let n=e.clientWidth,i=t[0].clientWidth,o=t.length*i,r=0,a=0,s=0,l=0;const d=(e,t,n)=>e*(1-n)+t*n,c=e=>{gsap.set(t,{x:t=>t*i+e,modifiers:{x:(e,t)=>`${gsap.utils.wrap(-i,o-i,parseInt(e))}px`}})};function handleMouseWheel(e){s-=.9*e.deltaY}c(0);let h=0,u=0,m=!1;const g=t=>{h=t.clientX||t.touches[0].clientX,m=!0,e.classList.add("is-dragging")},w=e=>{m&&(u=e.clientX||e.touches[0].clientX,s+=2.5*(u-h),h=u)},f=()=>{m=!1,e.classList.remove("is-dragging")};e.addEventListener("mousewheel",handleMouseWheel),e.addEventListener("touchstart",g),e.addEventListener("touchmove",w),e.addEventListener("touchend",f),e.addEventListener("mousedown",g),e.addEventListener("mousemove",w),e.addEventListener("mouseleave",f),e.addEventListener("mouseup",f),e.addEventListener("selectstart",(()=>!1)),window.addEventListener("resize",(()=>{n=e.clientWidth,i=t[0].clientWidth,o=t.length*i}));const y=()=>{requestAnimationFrame(y),l=d(l,s,.1),c(l),r=l-a,a=l,gsap.to(t,{skewX:.2*-r,rotate:.01*r,scale:1-.003*Math.min(100,Math.abs(r))})};y(),gsap.from(".carousel__item",{y:500,duration:1})}function bindModal(e,t,n){e=document.querySelector(e),t=document.querySelector(t),n=document.querySelector(n);const i=document.body;e.addEventListener("click",(e=>{e.preventDefault(),t.style.display="flex",i.classList.add("locked")})),n.addEventListener("click",(()=>{t.style.display="none",i.classList.remove("locked")})),t.addEventListener("click",(e=>{e.target===t&&(t.style.display="none",i.classList.remove("locked"))}))}bindModal(".contact-me__btn",".contact-me__wrapper",".contact-me__close");const element=document.querySelector(".phone__input"),maskOptions={mask:"+{7}(000)000-00-00"},element2=document.querySelector(".email__input"),maskOptions2={mask:/^\S*@?\S*$/},mask=IMask(element,maskOptions,element2,maskOptions2);document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("form");function t(e){e.parentElement.classList.add("error"),e.classList.add("error")}function n(e){e.parentElement.classList.remove("error"),e.classList.remove("error")}function i(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}e.addEventListener("submit",(async function(o){o.preventDefault();let r=function(e){let o=0,r=document.querySelectorAll(".required");for(let e=0;e<r.length;e++){const a=r[e];n(a),a.classList.contains("email")?i(a)&&(t(a),o++):""===a.value&&(t(a),o++)}return o}(),a=new FormData(e);if(0===r){let t=await fetch("sendmail.php",{method:"POST",body:a});if(t.ok){let n=await t.json();alert(n.message),e.reset()}else alert("Ошибка")}else alert("Заполните обязательные поля")}))}));